<!doctype html>
<html lang="pt-BR">
  <!-- Portal do Festival de Teatro do Recife â€¢ CatÃ¡logo -->
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Symplifica Conecta</title>
    <link
      rel="icon"
      href="https://statics.recife.pe.gov.br/images/dynamics/conecta/icons/favicon.png?w=32&h=32&fit=fill&border=2,transparent,shrink"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      :root {
        --brand-primary: #0053a4;
        --brand-secondary: #003a73;
        --brand-highlight: #00a3ff;
        --surface: #f4f7fb;
        --surface-strong: #ffffff;
        --border-color: #d0d7e2;
        --text-strong: #1b263b;
        --text-muted: #5b6c8c;
        --shadow-strong: 0 14px 30px rgba(0,35,79,.15);
      }
      *,*::before,*::after{box-sizing:border-box}
      body{
        font-family:"Public Sans",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
        background:var(--surface);color:var(--text-strong);min-height:100vh
      }
      header.site-header{
        background:url("https://statics.recife.pe.gov.br/images/dynamics/automacao/header.png?w=3000") center/cover no-repeat;
        color:#fff;padding:3rem 0 2.25rem
      }
      header .lead{color:rgba(255,255,255,.9);font-size:1rem;line-height:1.65}
      .badge-open{display:inline-flex;align-items:center;gap:.5rem;font-size:.95rem;font-weight:600;padding:.45rem .9rem;border-radius:999px;background:rgba(255,255,255,.14)}
      .section-title{display:flex;align-items:center;gap:.65rem;font-weight:700;font-size:1.2rem;color:var(--text-strong)}
      .section-title::before{content:"";display:inline-block;width:32px;height:3px;border-radius:999px;background:var(--brand-highlight)}
      .card-programa{border:1px solid rgba(0,83,164,.08);background:var(--surface-strong);box-shadow:0 16px 34px rgba(0,45,98,.08)}
      .catalog-toolbar .form-select,.catalog-toolbar .form-control{border-color:var(--border-color)}
      /* ===== Ticket card (estilo do exemplo) ===== */
      .ticket-card{
        background:#fff;border:1px solid rgba(0,0,0,.06);border-radius:12px;box-shadow:var(--shadow-strong);overflow:hidden;position:relative
      }
      .ticket-cover{background:#e9eef7}
      .poster-img{width:100%;height:100%;object-fit:cover;display:block}
      .ticket-body{padding:1rem 1rem 1.1rem;position:relative}
      /* SemicÃ­rculos nas laterais (efeito â€˜talÃ£oâ€™) */
      .ticket-body::before,.ticket-body::after{
        content:"";position:absolute;top:-12px;width:24px;height:24px;background:#fff;border:1px solid rgba(0,0,0,.06);border-radius:50%;
        box-shadow:0 0 0 6px #fff inset
      }
      .ticket-body::before{left:-12px}
      .ticket-body::after{right:-12px}
      .ci{display:inline-flex;align-items:center;justify-content:center;min-width:28px;height:28px;padding:0 .4rem;border-radius:6px;font-weight:800;font-size:.85rem;color:#fff}
      .ci.l{background:#2aa84a}     /* L */
      .ci.c10{background:#1f87c9}   /* 10 */
      .ci.c12{background:#f4b400}   /* 12 */
      .ci.c14{background:#ef6c00}   /* 14 */
      .ci.c16{background:#d84315}   /* 16 */
      .ci.c18{background:#212121}   /* 18 */
      .meta-label{font-size:.78rem;color:var(--text-muted)}
      .link-action{font-weight:700;text-decoration:none}
      .link-action:hover{text-decoration:underline}
      .btn-fav[aria-pressed="true"]{border-color:#ffc107!important}
      .catalog-grid .col{display:flex}
      .catalog-grid .ticket-card{display:flex;flex-direction:column;width:100%}
      @media (max-width:768px){header.site-header{padding:2.25rem 0 1.75rem}.badge-open{width:100%;justify-content:center}}
      @media (max-width:576px){.catalog-toolbar .row > * + *{margin-top:.5rem}}
    </style>
  </head>
  <body>
    <!-- HEADER -->
    <header class="site-header">
      <div class="container">
        <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3">
          <div>
            <h1 class="display-5 fw-bold mb-2">Desenrole aÃª â€¢ Symplifica Conecta</h1>
            <p class="lead mb-0">ProgramaÃ§Ã£o oficial da Secretaria de Cultura do Recife â€¢ Explore as peÃ§as e escolha seu teatro.</p>
          </div>
          <div class="text-md-end">
            <span class="badge-open"><span aria-hidden="true">ðŸŽ­</span> ProgramaÃ§Ã£o aberta</span>
            <div class="mt-2">
              <button class="btn btn-light btn-sm" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasFav" aria-controls="offcanvasFav">
                Favoritos <span class="badge text-bg-primary align-middle ms-1" id="favCount">0</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- FILTROS -->
    <section class="py-4">
      <div class="container">
        <div class="card card-programa">
          <div class="card-header"><div class="section-title mb-0">Filtrar programaÃ§Ã£o</div></div>
          <div class="card-body catalog-toolbar">
            <div class="row g-3 align-items-end">
              <div class="col-12 col-md-6 col-lg-5">
                <label class="form-label small fw-semibold text-uppercase text-muted">Busca</label>
                <input type="search" id="q" class="form-control" placeholder="Digite nome da peÃ§a, teatro ou trecho da sinopseâ€¦" />
              </div>
              <div class="col-6 col-md-3 col-lg-2">
                <label class="form-label small fw-semibold text-uppercase text-muted">Teatro</label>
                <select id="fTeatro" class="form-select"><option value="">Todos</option></select>
              </div>
              <div class="col-6 col-md-3 col-lg-2">
                <label class="form-label small fw-semibold text-uppercase text-muted">ClassificaÃ§Ã£o</label>
                <select id="fClass" class="form-select"><option value="">Todas</option></select>
              </div>
              <div class="col-6 col-md-3 col-lg-2">
                <label class="form-label small fw-semibold text-uppercase text-muted">GÃªnero</label>
                <select id="fGenero" class="form-select"><option value="">Todos</option></select>
              </div>
              <div class="col-6 col-md-3 col-lg-1 d-grid">
                <button id="btnLimpar" class="btn btn-outline-secondary">Limpar</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- CATÃLOGO -->
    <section class="py-3">
      <div class="container">
        <div class="d-flex align-items-center justify-content-between mb-3">
          <div class="section-title mb-0">CatÃ¡logo de peÃ§as</div>
          <small class="text-muted" id="resultInfo">Exibindo 0 de 0</small>
        </div>
        <div id="grid" class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-3 catalog-grid"></div>
      </div>
    </section>

    <!-- MODAL: DETALHES -->
    <div class="modal fade" id="modalDetalhes" tabindex="-1" aria-labelledby="modalTitulo" aria-hidden="true">
      <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title fw-bold" id="modalTitulo">TÃ­tulo da peÃ§a</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
          </div>
          <div class="modal-body">
            <div class="row g-3">
              <div class="col-12 col-md-5">
                <div class="ratio ratio-2x3 bg-light">
                  <img id="modalPoster" src="" alt="PÃ´ster da peÃ§a" class="w-100 h-100 poster-img rounded">
                </div>
              </div>
              <div class="col-12 col-md-7">
                <div class="mb-2"><span class="ci" id="modalClass">L</span></div>
                <p class="small text-uppercase text-muted fw-semibold mb-1">Teatro</p>
                <p class="fw-semibold" id="modalTeatro">â€”</p>
                <p class="small text-uppercase text-muted fw-semibold mb-1">Data</p>
                <p class="fw-semibold" id="modalQuando">â€”</p>
                <p class="small text-uppercase text-muted fw-semibold mb-1">GÃªnero</p>
                <p class="fw-semibold" id="modalGenero">â€”</p>
                <p class="mb-0 mt-3" id="modalSinopse">â€”</p>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button id="modalFavBtn" type="button" class="btn btn-outline-warning">Favoritar</button>
            <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Fechar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- OFFCANVAS: FAVORITOS -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasFav" aria-labelledby="offcanvasFavLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasFavLabel">Favoritos</h5>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Fechar"></button>
      </div>
      <div class="offcanvas-body">
        <div id="favList" class="list-group"></div>
        <div class="mt-3 d-flex gap-2">
          <button id="btnExportFav" class="btn btn-outline-primary btn-sm">Exportar IDs</button>
          <button id="btnClearFav" class="btn btn-outline-danger btn-sm">Limpar favoritos</button>
        </div>
      </div>
    </div>

    <!-- RODAPÃ‰ -->
    <footer class="py-5">
      <div class="container text-center small text-muted">
        Secretaria de Cultura do Recife â€¢ Prefeitura do Recife
      </div>
    </footer>

    <!-- SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // ====== Dataset (inclui 'genero') ======
      const pecas = [
        { id:"aurora-nas-esquinas", nome:"Aurora nas Esquinas", classificacao:"12+", genero:"Drama", teatro:"Teatro Santa Isabel",
          quando:"12 outubro, 16h", mapUrl:"#",
          sinopse:"Uma viagem poÃ©tica pelas ruas do Recife, onde memÃ³rias se cruzam com o cotidiano e cada esquina revela afetos e segredos que insistem em permanecer vivos.",
          poster:"https://deliriumnerd.com/wp-content/uploads/2019/08/aurora-nas-sombras-darkside-destacada-1024x538.jpg" },
        { id:"maresia", nome:"Maresia", classificacao:"Livre", genero:"Teatro-danÃ§a", teatro:"Teatro Apolo",
          quando:"13 outubro, 19h", mapUrl:"#",
          sinopse:"Entre calmarias e tempestades, uma famÃ­lia ribeirinha enfrenta mudanÃ§as climÃ¡ticas e afetivas, assinando pactos silenciosos com o vento e a marÃ©.",
          poster:"https://www.papocult.com.br/wp-content/uploads/2023/08/Cia-Acaso-Maresia-divulgacao.jpg" },
        { id:"o-auto-do-frevo", nome:"O Auto do Frevo", classificacao:"10+", genero:"Musical", teatro:"PaÃ§o do Frevo",
          quando:"14 outubro, 18h", mapUrl:"#",
          sinopse:"Musical festivo que mistura frevo, teatro e narrativa popular para contar a saga de um estandarte que ganha vida e sai em busca da sua orquestra.",
          poster:"https://midias.diariodepernambuco.com.br/static/app/noticia_127983242361/2016/12/15/680255/20161215172830466281i.jpg" },
        { id:"paredes-que-falam", nome:"Paredes que Falam", classificacao:"14+", genero:"Experimental", teatro:"Teatro Luiz MendonÃ§a",
          quando:"15 outubro, 20h", mapUrl:"#",
          sinopse:"Em um edifÃ­cio histÃ³rico prestes a ruir, moradores compartilham lembranÃ§as e disputas, enquanto o passado sussurra pelos azulejos e pelas portas entreabertas.",
          poster:"https://f.i.uol.com.br/fotografia/2025/04/02/174362328467ed947488792_1743623284_3x2_md.jpg" },
        { id:"cartas-para-clarice", nome:"Cartas para Clarice", classificacao:"16+", genero:"Drama", teatro:"Teatro Santa Isabel",
          quando:"16 outubro, 19h", mapUrl:"#",
          sinopse:"Fragmentos de cartas nunca enviadas se transformam em cena, explorando silÃªncio, identidade e a forÃ§a das pequenas escolhas que mudam destinos.",
          poster:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS5LP_4Fc1TXjepIRxOZuSCHMFhY6yKJhRSsg&s" },
        { id:"cidade-som", nome:"Cidade-Som", classificacao:"Livre", genero:"InstalaÃ§Ã£o cÃªnica", teatro:"Parque Dona Lindu",
          quando:"17 outubro, 17h", mapUrl:"#",
          sinopse:"InstalaÃ§Ã£o cÃªnica com mÃºsica ao vivo em que o pÃºblico percorre paisagens sonoras e descobre personagens escondidos no ruÃ­do da cidade.",
          poster:"https://www.ceara.gov.br/wp-content/uploads/2024/06/2024-04-12_Orquestra_Juruviara_ThiagoMatine-22-scaled.jpeg" },
        { id:"o-ultimo-fio", nome:"O Ãšltimo Fio", classificacao:"18+", genero:"TragÃ©dia", teatro:"Teatro Apolo",
          quando:"18 outubro, 21h", mapUrl:"#",
          sinopse:"Dois irmÃ£os costuram lembranÃ§as para nÃ£o esquecer o que o tempo tenta rasgar. Um drama Ã­ntimo sobre famÃ­lia, perda e possibilidades de recomeÃ§o.",
          poster:"https://www.garanhunsnoticias.com.br/images/noticias/124568/7c2c527a1ffdc43b66f3be20629667e9.jpeg" },
        { id:"couraÃ§a", nome:"CouraÃ§a", classificacao:"14+", genero:"Teatro fÃ­sico", teatro:"Teatro Luiz MendonÃ§a",
          quando:"19 outubro, 20h", mapUrl:"#",
          sinopse:"Corpos que danÃ§am e falas entrecortadas constroem um mosaico sobre proteÃ§Ã£o e vulnerabilidade em tempos de urgÃªncia.",
          poster:"https://www.estadao.com.br/blogs/blog/wp-content/uploads/sites/265/2015/10/Jaques-e-Seu-Amo-HugoPossolo-Ando-Camargo-Angelo-Brandini-foto-de-Jo%C3%A3o-Caldas-e1444340873610.jpg" },
        { id:"menina-e-o-vento", nome:"A Menina e o Vento", classificacao:"10+", genero:"Infantil", teatro:"PaÃ§o do Frevo",
          quando:"20 outubro, 16h", mapUrl:"#",
          sinopse:"A amizade improvÃ¡vel entre uma crianÃ§a curiosa e um vento brincalhÃ£o desafia regras e apresenta uma nova forma de habitar o mundo.",
          poster:"https://www.sociedadehumboldt.org.br/conteudo/comunicacao/dicas/teatro/1206294/1.jpg" },
        { id:"rio-subterraneo", nome:"Rio SubterrÃ¢neo", classificacao:"12+", genero:"Suspense", teatro:"Parque Dona Lindu",
          quando:"21 outubro, 18h", mapUrl:"#",
          sinopse:"Narrativa que revela um Recife oculto sob as Ã¡guas, onde memÃ³rias afundadas retornam para guiar um grupo em busca de pertencimento.",
          poster:"https://s2-oglobo.glbimg.com/Vg94jDR50UtDXMDM39fXOg8nRU0=/0x0:4928x3280/924x0/smart/filters:strip_icc()/i.s3.glbimg.com/v1/AUTH_da025474c0c44edd99332dddb09cabe8/internal_photos/bs/2023/j/q/UyrFCpTqKuAdvuqyYJYQ/perversa-monica-bittencourt-em-cena-5-credito-da-foto-bruna-diacoyannis-1-.jpeg" }
      ];

      // ====== Utilidades / estado ======
      const $ = (s,el=document)=>el.querySelector(s);
      const $$ = (s,el=document)=>Array.from(el.querySelectorAll(s));
      const KEY_FAV="ftr_favs";

      const elGrid=$("#grid"), elResultInfo=$("#resultInfo"), elQ=$("#q"),
            elFTeatro=$("#fTeatro"), elFClass=$("#fClass"), elFGenero=$("#fGenero"), elBtnLimpar=$("#btnLimpar"),
            elFavCount=$("#favCount"), offcanvasFav=$("#offcanvasFav"),
            elFavList=$("#favList"), elBtnExportFav=$("#btnExportFav"), elBtnClearFav=$("#btnClearFav");

      const modal = new bootstrap.Modal($("#modalDetalhes"));
      const mTitle=$("#modalTitulo"), mPoster=$("#modalPoster"), mClass=$("#modalClass"),
            mTeatro=$("#modalTeatro"), mQuando=$("#modalQuando"), mGenero=$("#modalGenero"),
            mSinopse=$("#modalSinopse"), mFavBtn=$("#modalFavBtn");

      const getFavs=()=>{try{return JSON.parse(localStorage.getItem(KEY_FAV)||"[]")}catch{return []}};
      const setFavs=(a)=>localStorage.setItem(KEY_FAV,JSON.stringify(a));
      const isFav=(id)=>getFavs().includes(id);
      const updateFavCount=()=>{elFavCount.textContent=getFavs().length};
      const unique=(arr)=>[...new Set(arr)].sort((a,b)=>a.localeCompare(b,"pt-BR"));

      // SÃ­mbolo de classificaÃ§Ã£o (cores e rÃ³tulo)
      function classSymbol(cl){
        const map={
          "Livre":{cls:"l",label:"L"},
          "10+":{cls:"c10",label:"10"},
          "12+":{cls:"c12",label:"12"},
          "14+":{cls:"c14",label:"14"},
          "16+":{cls:"c16",label:"16"},
          "18+":{cls:"c18",label:"18"},
        };
        const m = map[cl]||map["Livre"];
        return `<span class="ci ${m.cls}" title="ClassificaÃ§Ã£o: ${cl}" aria-label="ClassificaÃ§Ã£o ${cl}">${m.label}</span>`;
      }

      // ====== Filtros ======
      function renderFilters(){
        unique(pecas.map(p=>p.teatro)).forEach(t=>{
          const o=document.createElement("option");o.value=t;o.textContent=t;elFTeatro.appendChild(o);
        });
        unique(pecas.map(p=>p.classificacao)).forEach(c=>{
          const o=document.createElement("option");o.value=c;o.textContent=c;elFClass.appendChild(o);
        });
        unique(pecas.map(p=>p.genero)).forEach(g=>{
          const o=document.createElement("option");o.value=g;o.textContent=g;elFGenero.appendChild(o);
        });
      }

      // ====== Favoritos ======
      function toggleFav(id){
        const curr=getFavs(); const i=curr.indexOf(id);
        if(i>=0) curr.splice(i,1); else curr.push(id);
        setFavs(curr); updateFavCount(); renderFavList();
        $$(`button[data-fav="${id}"]`).forEach(btn=>{
          const on=curr.includes(id);
          btn.setAttribute("aria-pressed", on ? "true":"false");
          btn.classList.toggle("btn-outline-warning", !on);
          btn.classList.toggle("btn-warning", on);
          btn.innerHTML= on ? "â˜… Favorito" : "â˜† Favoritar";
        });
        return curr.includes(id);
      }

      function renderFavList(){
        const ids=getFavs();
        if(!ids.length){ elFavList.innerHTML = `<div class="text-center text-muted">Nenhuma peÃ§a favoritada ainda.</div>`; return; }
        elFavList.innerHTML = ids
          .map(id=>pecas.find(p=>p.id===id)).filter(Boolean)
          .map(p=>`
            <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-start">
              <div class="me-3">
                <div class="fw-semibold">${p.nome}</div>
                <small>${p.teatro} â€¢ ${classSymbol(p.classificacao)} â€¢ ${p.genero}</small>
              </div>
              <div class="btn-group btn-group-sm">
                <button class="btn btn-outline-primary" data-jump="${p.id}" data-bs-dismiss="offcanvas">Abrir</button>
                <button class="btn btn-outline-danger" data-remove="${p.id}">Remover</button>
              </div>
            </a>`).join("");
        $$("button[data-remove]",elFavList).forEach(b=>b.addEventListener("click",e=>{e.preventDefault();toggleFav(b.getAttribute("data-remove"));}));
        $$("button[data-jump]",elFavList).forEach(b=>b.addEventListener("click",e=>{e.preventDefault();openDetails(b.getAttribute("data-jump"));}));
      }

      // ====== Card (estilo ingresso) ======
      function cardTemplate(p){
        const fav=isFav(p.id);
        return `
          <div class="col">
            <div class="ticket-card h-100">
              <div class="ticket-cover ratio ratio-16x9">
                <img loading="lazy" src="${p.poster}" alt="PÃ´ster da peÃ§a ${p.nome}" class="poster-img">
              </div>
              <div class="ticket-body">
                <div class="d-flex align-items-center justify-content-between mb-1">
                  <h5 class="mb-0 fw-bold text-truncate" title="${p.nome}">${p.nome}</h5>
                  ${classSymbol(p.classificacao)}
                </div>

                <div class="row g-2 mt-2">
                  <div class="col-7">
                    <div class="meta-label">Local</div>
                    <div class="fw-semibold small text-truncate" title="${p.teatro}">${p.teatro}</div>
                  </div>
                  <div class="col-5 text-end">
                    <a href="${p.mapUrl||'#'}" class="link-action small text-primary" target="_blank" rel="noopener">VER LOCAL</a>
                  </div>

                  <div class="col-7">
                    <div class="meta-label">Data</div>
                    <div class="fw-semibold small">${p.quando||'â€”'}</div>
                  </div>
                  <div class="col-5 text-end">
                    <button class="btn btn-link link-action small p-0" data-details="${p.id}">DETALHES</button>
                  </div>

                  <div class="col-12">
                    <div class="meta-label">GÃªnero</div>
                    <div class="fw-semibold small">${p.genero}</div>
                  </div>
                </div>

                <div class="d-flex gap-2 mt-3">
                  <button class="btn ${fav?'btn-warning':'btn-outline-warning'} btn-sm" data-fav="${p.id}" aria-pressed="${fav}">
                    ${fav ? 'â˜… Favorito' : 'â˜† Favoritar'}
                  </button>
                  <button class="btn btn-primary btn-sm" data-details="${p.id}">Abrir detalhes</button>
                </div>
              </div>
            </div>
          </div>`;
      }

      function renderGrid(list){
        elGrid.innerHTML = list.map(cardTemplate).join("");
        elResultInfo.textContent = `Exibindo ${list.length} de ${pecas.length}`;
        $$("button[data-details]").forEach(b=>b.addEventListener("click",()=>openDetails(b.getAttribute("data-details"))));
        $$("button[data-fav]").forEach(b=>b.addEventListener("click",()=>toggleFav(b.getAttribute("data-fav"))));
      }

      // ====== Busca/Filtros ======
      function applyFilters(){
        const q = elQ.value.trim().toLowerCase();
        const t = elFTeatro.value;
        const c = elFClass.value;
        const g = elFGenero.value;

        const filtered = pecas.filter(p=>{
          const text = !q || [p.nome,p.teatro,p.sinopse,(p.genero||'')].some(v=>v.toLowerCase().includes(q));
          const teat = !t || p.teatro===t;
          const clas = !c || p.classificacao===c;
          const genr = !g || p.genero===g;
          return text && teat && clas && genr;
        });
        renderGrid(filtered);
      }
      function resetFilters(){
        elQ.value=""; elFTeatro.value=""; elFClass.value=""; elFGenero.value="";
        renderGrid(pecas);
      }

      // ====== Detalhes (Modal) ======
      function openDetails(id){
        const p = pecas.find(x=>x.id===id); if(!p) return;
        mTitle.textContent = p.nome;
        mPoster.src = p.poster; mPoster.alt = `PÃ´ster da peÃ§a ${p.nome}`;
        // sÃ­mbolo no modal
        mClass.className = "ci " + ({"Livre":"l","10+":"c10","12+":"c12","14+":"c14","16+":"c16","18+":"c18"}[p.classificacao]||"l");
        mClass.textContent = ({"Livre":"L","10+":"10","12+":"12","14+":"14","16+":"16","18+":"18"}[p.classificacao]||"L");
        mTeatro.textContent = p.teatro;
        mQuando.textContent = p.quando || "â€”";
        mGenero.textContent = p.genero || "â€”";
        mSinopse.textContent = p.sinopse;
        mFavBtn.dataset.id = p.id;
        reflectModalFav(isFav(p.id));
        modal.show();
      }
      function reflectModalFav(pressed){
        mFavBtn.classList.toggle("btn-outline-warning", !pressed);
        mFavBtn.classList.toggle("btn-warning", pressed);
        mFavBtn.textContent = pressed ? "Remover dos favoritos" : "Favoritar";
        mFavBtn.setAttribute("aria-pressed", pressed ? "true":"false");
      }
      mFavBtn.addEventListener("click",()=>{
        const id=mFavBtn.dataset.id;
        const now=toggleFav(id);
        reflectModalFav(now);
      });

      // ====== Offcanvas eventos ======
      offcanvasFav.addEventListener("show.bs.offcanvas", renderFavList);
      elBtnExportFav.addEventListener("click",()=>{
        const ids=getFavs(); if(!ids.length) return alert("Nenhum favorito para exportar.");
        navigator.clipboard.writeText(ids.join(", ")).then(()=>alert("IDs copiados para a Ã¡rea de transferÃªncia."));
      });
      elBtnClearFav.addEventListener("click",()=>{
        if(confirm("Limpar todos os favoritos?")){
          localStorage.setItem(KEY_FAV,"[]"); updateFavCount(); renderFavList(); renderGrid(pecas);
        }
      });

      // ====== Eventos dos filtros ======
      [elQ, elFTeatro, elFClass, elFGenero].forEach(el=>{
        el.addEventListener("input", applyFilters);
        el.addEventListener("change", applyFilters);
      });
      elBtnLimpar.addEventListener("click", resetFilters);

      // ====== Boot ======
      (function init(){
        renderFilters(); updateFavCount(); renderGrid(pecas);
      })();
    </script>
  </body>
</html>
